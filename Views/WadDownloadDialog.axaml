<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="ZScape.Views.WadDownloadDialog"
        x:CompileBindings="False"
        Title="WAD Download"
        Width="700" Height="500"
        WindowStartupLocation="CenterOwner"
        MinWidth="500" MinHeight="400"
        ExtendClientAreaToDecorationsHint="False">
    
    <Grid Margin="10" RowDefinitions="30,*,30,*,40">
        <!-- Status label -->
        <TextBlock Grid.Row="0" x:Name="StatusLabel" Text="Downloading..." 
                   VerticalAlignment="Center"/>
        
        <!-- WAD list with header -->
        <Border Grid.Row="1" BorderBrush="#3F3F46" BorderThickness="1" CornerRadius="2">
            <Grid RowDefinitions="Auto,*">
                <!-- Column headers -->
                <Border Grid.Row="0" Background="#252526" BorderBrush="#3F3F46" BorderThickness="0,0,0,1">
                    <Grid ColumnDefinitions="180,90,140,90,60,*" Height="28">
                        <TextBlock Grid.Column="0" Text="File" VerticalAlignment="Center" Margin="8,0" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="1" Text="Status" VerticalAlignment="Center" Margin="4,0" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="2" Text="Progress" VerticalAlignment="Center" Margin="4,0" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="3" Text="Speed" VerticalAlignment="Center" Margin="4,0" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="4" Text="Threads" VerticalAlignment="Center" Margin="4,0" FontWeight="SemiBold"/>
                        <TextBlock Grid.Column="5" Text="Source" VerticalAlignment="Center" Margin="4,0" FontWeight="SemiBold"/>
                    </Grid>
                </Border>
                
                <!-- Scrollable items -->
                <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                    <ItemsControl x:Name="WadListControl">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{Binding RowBackground}" BorderBrush="#3F3F46" BorderThickness="0,0,0,1" Height="24">
                                    <Grid ColumnDefinitions="180,90,140,90,60,*">
                                        <TextBlock Grid.Column="0" Text="{Binding FileName}" VerticalAlignment="Center" Margin="8,0" TextTrimming="CharacterEllipsis" Foreground="{Binding StatusColor}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding StatusDisplay}" VerticalAlignment="Center" Margin="4,0" Foreground="{Binding StatusColor}"/>
                                        <TextBlock Grid.Column="2" Text="{Binding ProgressText}" VerticalAlignment="Center" Margin="4,0" Foreground="{Binding StatusColor}"/>
                                        <TextBlock Grid.Column="3" Text="{Binding SpeedText}" VerticalAlignment="Center" Margin="4,0" Foreground="{Binding StatusColor}"/>
                                        <TextBlock Grid.Column="4" Text="{Binding ThreadsDisplay}" VerticalAlignment="Center" Margin="4,0" HorizontalAlignment="Center" Foreground="{Binding StatusColor}"/>
                                        <TextBlock Grid.Column="5" Text="{Binding SourceHost}" VerticalAlignment="Center" Margin="4,0" TextTrimming="CharacterEllipsis" Foreground="{Binding StatusColor}"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </Border>
        
        <!-- Overall progress bar -->
        <ProgressBar Grid.Row="2" x:Name="OverallProgressBar" Minimum="0" Maximum="100" Value="0" Height="20"/>
        
        <!-- Log panel -->
        <Border Grid.Row="3" BorderBrush="#3F3F46" BorderThickness="1" CornerRadius="2">
            <ScrollViewer x:Name="LogScrollViewer" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                <ItemsControl x:Name="LogControl" FontFamily="Consolas" FontSize="12"/>
            </ScrollViewer>
        </Border>
        
        <!-- Button panel -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Spacing="8">
            <Button x:Name="CancelButton" Content="Cancel" Width="80" Height="28" Click="CancelButton_Click"/>
            <Button x:Name="CloseButton" Content="Close" Width="80" Height="28" IsEnabled="False" Click="CloseButton_Click"/>
        </StackPanel>
    </Grid>
</Window>
